df_cox2025 <- read.csv("~/Universidad/ContribucionCientificaTecnologica/COX_2024/data/df_cox2025.csv")
View(df_cox2025)
# Cargar el paquete
library(survival)
library(survminer)
# Convertir comorbilidades a factores (opcional pero recomendado)
#comorbilidades <- c('DIABETES', 'HIPERTENSION','CARDIOVASCULAR',
#                    'OBESIDAD', 'TABAQUISMO')
# Convertir comorbilidades a factores (opcional pero recomendado)
comorbilidades <- c('NEUMONIA', 'DIABETES', 'EPOC', 'ASMA', 'INMUSUPR',
'HIPERTENSION', 'CARDIOVASCULAR',
'OBESIDAD', 'RENAL_CRONICA', 'TABAQUISMO')
# Convierte las comorbilidades a factores
df_cox2025[comorbilidades] <- lapply(df_cox2025[comorbilidades], factor)
# Definir la fórmula del modelo de Cox
#formula_cox <- as.formula("Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ DIABETES + HIPERTENSION + CARDIOVASCULAR + OBESIDAD + TABAQUISMO")
# Definir la fórmula del modelo de Cox
formula_cox <- as.formula("Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA + DIABETES + EPOC +
ASMA + INMUSUPR + HIPERTENSION + OBESIDAD +
CARDIOVASCULAR + RENAL_CRONICA + TABAQUISMO")
# Ajustar el modelo de Cox
modelo_cox <- coxph(formula_cox, data = df_cox2025)
# Ver el resumen del modelo
summary(modelo_cox)
test_schoenfeld_estrat <- cox.zph(modelo_cox_estrat)
### Test de Schoenfeld
test_schoenfeld <- cox.zph(modelo_cox)
print(test_schoenfeld)
# Gráfico de residuos de Schoenfeld
ggcoxzph(cox.zph(modelo_cox))
plot(test_schoenfeld)
# Gráfico de residuos de Schoenfeld
ggcoxzph(cox.zph(modelo_cox))
# Nueva fórmula con estratificación
formula_cox_corr <- as.formula("Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA + NEUMONIA_TIEMPO +
DIABETES + EPOC + ASMA + INMUSUPR + HIPERTENSION +
OBESIDAD + RENAL_CRONICA + TABAQUISMO + strata(CARDIOVASCULAR)")
# Ajustar el modelo con estratificación
modelo_cox_corr <- coxph(formula_cox_corr, data = df_cox2025)
# Crear la interacción NEUMONIA * log(tiempo)
df_cox2025$NEUMONIA_TIEMPO <- df_cox2025$NEUMONIA * log(df_cox2025$DIAS_SINTOMAS_DEF)
# Nueva fórmula con estratificación
formula_cox_corr <- as.formula("Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA + NEUMONIA_TIEMPO +
DIABETES + EPOC + ASMA + INMUSUPR + HIPERTENSION +
OBESIDAD + RENAL_CRONICA + TABAQUISMO + strata(CARDIOVASCULAR)")
# Ajustar el modelo con estratificación
modelo_cox_corr <- coxph(formula_cox_corr, data = df_cox2025)
# Crear la interacción NEUMONIA * log(tiempo)
df_cox2025$NEUMONIA_TIEMPO <- df_cox2025$NEUMONIA * log(df_cox2025$DIAS_SINTOMAS_DEF)
df_cox2025 <- read.csv("~/Universidad/ContribucionCientificaTecnologica/COX_2024/data/df_cox2025.csv")
View(df_cox2025)
# Definir la fórmula del modelo de Cox
formula_cox <- as.formula("Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA + DIABETES + EPOC +
ASMA + INMUSUPR + HIPERTENSION + OBESIDAD +
CARDIOVASCULAR + RENAL_CRONICA + TABAQUISMO")
# Ajustar el modelo de Cox
modelo_cox <- coxph(formula_cox, data = df_cox2025)
# Ver el resumen del modelo
summary(modelo_cox)
### Test de Schoenfeld
test_schoenfeld <- cox.zph(modelo_cox)
print(test_schoenfeld)
# Crear la interacción NEUMONIA * log(tiempo)
df_cox2025$NEUMONIA_TIEMPO <- df_cox2025$NEUMONIA * log(df_cox2025$DIAS_SINTOMAS_DEF)
# Nueva fórmula con estratificación
formula_cox_corr <- as.formula("Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA + NEUMONIA_TIEMPO +
DIABETES + EPOC + ASMA + INMUSUPR + HIPERTENSION +
OBESIDAD + RENAL_CRONICA + TABAQUISMO + strata(CARDIOVASCULAR)")
# Ajustar el modelo con estratificación
modelo_cox_corr <- coxph(formula_cox_corr, data = df_cox2025)
View(df_cox2025)
# Crear la interacción NEUMONIA * log(tiempo)
df_cox2025$NEUMONIA_TIEMPO <- df_cox2025$NEUMONIA * log(df_cox2025$DIAS_SINTOMAS_DEF + 1)
# Nueva fórmula con estratificación
formula_cox_corr <- as.formula("Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA + NEUMONIA_TIEMPO +
DIABETES + EPOC + ASMA + INMUSUPR + HIPERTENSION +
OBESIDAD + RENAL_CRONICA + TABAQUISMO + strata(CARDIOVASCULAR)")
# Ajustar el modelo con estratificación
modelo_cox_corr <- coxph(formula_cox_corr, data = df_cox2025)
# Ver el resumen del modelo corregido
summary(modelo_cox_corr)
# Curva de supervivencia para NEUMONIA
ggsurvplot(survfit(Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA, data = df_cox2025),
risk.table = TRUE, pval = TRUE,
title = "Curvas de Supervivencia - NEUMONIA")
test_schoenfeld <- cox.zph(modelo_cox)
print(test_schoenfeld)
# Curva de supervivencia para NEUMONIA
ggsurvplot(survfit(Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA, data = df_cox2025),
risk.table = TRUE, pval = TRUE,
title = "Curvas de Supervivencia - NEUMONIA")
# Curva de supervivencia para NEUMONIA
ggsurvplot(survfit(Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA, data = df_cox2025),
risk.table = TRUE, pval = TRUE,
linetype = "strata",
surv.median.line = "hv",
title = "Curvas de Supervivencia - NEUMONIA")
ggsurvplot(survfit(Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA, data = df_cox2025),
pval = TRUE, conf.int = TRUE,
risk.table = TRUE,
risk.table.col = "strata",
linetype = "strata",
surv.median.line = "hv",
ggtheme = theme_bw(),
palette = c(#E7B800","2E9FDF"))
# Curva de supervivencia para NEUMONIA
ggsurvplot(survfit(Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA, data = df_cox2025),
pval = TRUE, conf.int = TRUE,
risk.table = TRUE,
risk.table.col = "strata",
linetype = "strata",
surv.median.line = "hv",
ggtheme = theme_bw(),
palette = c("#E7B800","2E9FDF"))
)
# Curva de supervivencia para NEUMONIA
ggsurvplot(survfit(Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA, data = df_cox2025),
ggsurvplot(survfit(Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA, data = df_cox2025),
pval = TRUE, conf.int = TRUE,
risk.table = TRUE,
risk.table.col = "strata",
linetype = "strata",
surv.median.line = "hv",
ggtheme = theme_bw())
ggsurvplot(survfit(Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA, data = df_cox2025))
df_cox2025 <- read.csv("~/Universidad/ContribucionCientificaTecnologica/COX_2024/data/df_cox2025.csv")
View(df_cox2025)
modelo_cox_2025 <- coxph(Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA + DIABETES + EPOC +
ASMA + INMUSUPR + HIPERTENSION + OBESIDAD +
CARDIOVASCULAR + RENAL_CRONICA + TABAQUISMO, data = df_cox2025)
library(survival)
modelo_cox_2025 <- coxph(Surv(DIAS_SINTOMAS_DEF, DEFUNCION) ~ NEUMONIA + DIABETES + EPOC +
ASMA + INMUSUPR + HIPERTENSION + OBESIDAD +
CARDIOVASCULAR + RENAL_CRONICA + TABAQUISMO, data = df_cox2025)
modelo_cox_2025
summary(modelo_cox_2025)
test.ph <- cox.zph(modelo_cox_2025)
test.ph
modelo_cox_2025$meses <- datos$DIAS_SINTOMAS_DEF / 30.44  # Aproximadamente 30.44 días por mes
View(df_cox2025)
df_cox2025$meses <- datos$DIAS_SINTOMAS_DEF / 30.44  # Aproximadamente 30.44 días por mes
View(df_cox2025)
df_cox2025$meses <- df_cox2025$DIAS_SINTOMAS_DEF / 30.44  # Aproximadamente 30.44 días por mes
modelo_cox_2025 <- coxph(Surv(meses, DEFUNCION) ~ NEUMONIA + DIABETES + EPOC +
ASMA + INMUSUPR + HIPERTENSION + OBESIDAD +
CARDIOVASCULAR + RENAL_CRONICA + TABAQUISMO, data = df_cox2025)
summary(modelo_cox_2025)
test.ph <- cox.zph(modelo_cox_2025)
test.ph
